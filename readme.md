###### :orange_book: Hexagon entry article (readme.md)

---

# Hexagon

**Hexagon** – это функциональное дополнение к DocHub-репозиториям (DocHub add-on)

###### TBD:
    Hexagon - опция. Hexed apps. 

Для описания архитектуры в виде кода в Hexagon используется yaml и ряд json schemas, образующих hex-native язык:
* декларирование объектов и отношений в формате направленного графа, где объекты представлены вершинами (узлами, nodes), а отношения -- ребрами (связями, edges);
* запросы (queries) к графу следующего вида: все ноды, которые имеют связь (любую или определенную) с нодами, которые имеют связь... Не путать с jsonata-запросами.
* описание представлений архитектуры в виде pattern(комбинация запросов) + landscape(результат комбинации запросов) с возможностью предоставления пользователю DH-портала применения фильтров
* интерпретация кода архитектуры, написанного в других схемах (TBD)

#### Декларирование объектов и отношений
Все объекты архитектуры с точки зрения Hexagon являются однотипными или True Typeless (ttl). То есть и объект "Горный терминал", и объект "Куб из сферы" будут относиться к типу ttl. Поэтому декларирование этих объектов будет выглядеть следующим образом:
```yaml
ttl:                               # раздел манифеста, в котором объявляются любые объекты архитектуры
    mountine_terminal:             # уникальный идентификатор объекта (рекомендуем использовать концепцию DDD)
        title: Горный терминал     # наименование наименование объекта

    sphere_cube_transform:
        title: Куб из сферы
```

Если между парой объектов архитектуры существует отношение, например "Трансформация 'Куб из сферы' *доступна в* 'Горном терминале'  ", то объявляение такого отношения осуществляется следующим образом:
```yaml
ttl:                        
    mountine_terminal:              
        title: Горный терминал

    sphere_cube_transform:          # объект-источник (source) связи
        title: Куб из сферы
        hex:                        # атрибут объекта в котором объявляются связи
            =>доступен:             # направление и наименование связи
                mountine_terminal:  # объект-приемник (target) связи
```

На данном этапе ни DH, ни Hexagon ничего "не знают" о природе декларируемых объектов. Это два каких-то связанных объекта. Для того, что бы в дальнейшем опрерировать такими категориями как "Терминал" и "Трансформация", их необходимо задекларировать, как и "обычные" объекты:

```yaml
ttl:                        
    terminal:              
        title: Терминал

    transformation:          
        title: Трансформация
```
Для того, чтобы "Горный терминал" и "Куб из сферы" относились к категории (классу, признаку и т.д.) "Терминал" и "Трансформация" соответственно, необходимо задеклариировать отношения между классами и экземплярами. В примере ниже используется отношение `map`, но можно выбрать любое отношение:
```yaml
ttl:                        
    mountine_terminal:              
        title: Горный терминал
        hex:
            =>map:                  # мэппинг Горного терминала
                terminal:           # на класс Терминал

    sphere_cube_transform:          
        title: Куб из сферы
        hex:
            =>map:                  # мэппинг Куб из сферы
                transformation:     # на класс Трансформация
            =>доступен:            
                mountine_terminal:  
```
###### в папке hexagon/articles/abstract_example находится манифест с примером вымышленных Терминалов и доступных трансформаций. Подключите манифест terminals.yaml

Для получения перечня всех объектов  и отношений можно воспользоваться jsonata-запросами:
```jsonata
$eval($$.hexF.nodes) /* все объекты */
```
```jsonata
$eval($$.hexF.edges) /* все отношения */
```

[подробнее о декларировании объектов и отношений](/entities/articles/blank?id=hex_declare)

#### Запросы к графу
Запрос - это специальный атрибут `hexQ` ttl-объекта, описывающий условия по наличию/отсутствию отношений с другими объектами. Запросы возвращают массив идентификаторов объектов архитектуры, удовлетворяющих заданным условиям. 

Например, требуется получить перечень всех терминалов:
```yaml
ttl:
    all_terminals:              # идентификатор запроса
        title: все терминалы    # имя запроса
        hexQ:                   # атрибут, содержащий запрос
            ttl:                # все ttl-объекты, которые
                EXACT=>map:     # в обязательном порядке имеют исходящую связь "map"
                    terminal:   # к объекту terminal
```
Выполнить запрос можно с помощью jsonata:
```jsonata
$eval($$.hexF.queryExe, {"qId": "all_terminals"})
```
Поскольку запрос - это ttl-объект, то мы можем поместить тело запроса, например в объект terminal:
```yaml
ttl:                        
    terminal:              
        title: Терминал
        hexQ:                   
            ttl:                
                EXACT=>map:     
                    terminal:   
```
Теперь при обращении terminal является и обычным ttl-объектом и запросом одновременно:
```jsonata
(
    $lookup(ttl, "terminal").title;              /* Терминал */
    eval($$.hexF.queryExe, {"qId": "terminal"}); /* [
                                                        "mountine_terminal",
                                                        "river_terminal",
                                                        "valley_terminal",
                                                        "desert_terminal",
                                                        "sea_terminal",
                                                        "forest_terminal"
                                                    ]
                                                 */
)
```
[Подробнее о запросах](/entities/articles/blank?id=hex_queries)
###### Фичи TBD:
Описание метамоделей и других классификаторов
Обзорные представления, Представления Метамодель+Ландшафт, видимый в соответствии с метамоделью

Для описания архитектуры в виде кода и визуализации кода архитектуры в Hexagon используется  

Работает с манифестами:
* любой схемы при наличии транслятора (не трансформирует данные)
* hex-native схемы

Предоставляет функциональность:
* трансляторов
* графовые функции (пути)
* деривативы
* запросы к озеру на hex-native языке

Визуализирует:
* озеро
* результаты запросов
* интерактивное взаимодействие в UI
    * селекторы
    * patterns
    * collapse/expand
    * pull-in/push-out
    * focusing
    * drill down

Конструктор методологий:
* Исходное: nodes and edges
* Инструменты:
    * dimensional and regular edges
    * scopes
    * timeline
    * task management
    * proto/meta models

